<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Address Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --clay: #D4A574;
            --terracotta: #C86B3C;
            --earth: #8B5A3C;
            --sand: #F4E8D8;
            --ink: #2A2A2A;
            --paper: #FFFEF9;
            --accent: #E8997A;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Pro', serif;
            background: linear-gradient(135deg, var(--paper) 0%, var(--sand) 100%);
            color: var(--ink);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.02) 2px, rgba(0,0,0,0.02) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(0,0,0,0.02) 2px, rgba(0,0,0,0.02) 4px);
            pointer-events: none;
            z-index: 1;
        }

        .container {
            position: relative;
            z-index: 2;
            max-width: 1400px;
            margin: 0 auto;
            padding: 4rem 2rem;
        }

        header {
            margin-bottom: 4rem;
            position: relative;
        }

        h1 {
            font-family: 'Space Mono', monospace;
            font-size: clamp(2.5rem, 6vw, 5rem);
            font-weight: 700;
            color: var(--earth);
            line-height: 0.95;
            letter-spacing: -0.03em;
            margin-bottom: 1rem;
            text-transform: uppercase;
            animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--terracotta);
            font-weight: 400;
            letter-spacing: 0.02em;
            animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.1s both;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 3rem;
            animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.2s both;
        }

        /* Custom Select Styles */
        .custom-select {
            position: relative;
            min-width: 300px;
            flex: 1;
            max-width: 450px;
        }

        .select-trigger {
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            padding: 1rem 1.5rem;
            border: 2px solid var(--earth);
            background: var(--paper);
            color: var(--ink);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            overflow: hidden;
        }

        .select-trigger::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--sand);
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s;
        }

        .select-trigger:hover::before {
            width: 400px;
            height: 400px;
        }

        .select-trigger-content {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .selected-flag {
            font-size: 1.3rem;
        }

        .select-trigger:hover {
            border-color: var(--terracotta);
            transform: translateY(-2px);
        }

        .select-trigger.active {
            border-color: var(--terracotta);
            background: var(--sand);
        }

        .select-arrow {
            font-size: 0.7rem;
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            z-index: 1;
        }

        .select-trigger.active .select-arrow {
            transform: rotate(180deg);
        }

        .select-dropdown {
            position: absolute;
            top: calc(100% + 0.5rem);
            left: 0;
            right: 0;
            background: var(--paper);
            border: 2px solid var(--earth);
            max-height: 450px;
            overflow-y: auto;
            z-index: 1000;
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 12px 12px 0 var(--clay);
        }

        .select-dropdown.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .select-search {
            position: sticky;
            top: 0;
            background: var(--sand);
            padding: 1rem;
            border-bottom: 2px solid var(--clay);
            z-index: 10;
        }

        .select-search input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--earth);
            background: var(--paper);
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            color: var(--ink);
        }

        .select-search input::placeholder {
            color: var(--clay);
        }

        .select-search input:focus {
            outline: none;
            border-color: var(--terracotta);
        }

        .select-options {
            padding: 0.5rem;
        }

        .select-option {
            padding: 0.875rem 1rem;
            cursor: pointer;
            font-family: 'Crimson Pro', serif;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }

        .select-option:hover {
            background: var(--sand);
            border-left-color: var(--terracotta);
            padding-left: 1.25rem;
        }

        .select-option.selected {
            background: var(--earth);
            color: var(--paper);
            font-weight: 600;
        }

        .option-flag {
            font-size: 1.4rem;
            min-width: 2rem;
            text-align: center;
        }

        .option-content {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .option-label {
            flex: 1;
        }

        .option-region {
            font-size: 0.7rem;
            color: var(--earth);
            font-family: 'Space Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            background: var(--sand);
            padding: 0.25rem 0.5rem;
        }

        .select-option.selected .option-region {
            background: var(--clay);
            color: var(--paper);
        }

        .no-results {
            padding: 2rem;
            text-align: center;
            color: var(--earth);
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
        }

        button {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            padding: 1rem 1.5rem;
            border: 2px solid var(--earth);
            background: var(--paper);
            color: var(--ink);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            position: relative;
            overflow: hidden;
        }

        button.primary {
            background: var(--earth);
            color: var(--paper);
        }

        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--terracotta);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:hover::before {
            width: 300px;
            height: 300px;
        }

        button span {
            position: relative;
            z-index: 1;
        }

        button:hover {
            border-color: var(--terracotta);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
            animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.3s both;
        }

        .address-card {
            background: var(--paper);
            border: 2px solid var(--clay);
            padding: 2rem;
            position: relative;
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            animation: cardIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) both;
        }

        @keyframes cardIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .address-card:hover {
            transform: translateY(-8px);
            box-shadow: 12px 12px 0 var(--clay);
            border-color: var(--terracotta);
        }

        .address-card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, var(--clay), var(--accent));
            z-index: -1;
            opacity: 0;
            transition: opacity 0.4s;
        }

        .address-card:hover::before {
            opacity: 0.1;
        }

        .country-tag {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--paper);
            background: var(--terracotta);
            padding: 0.4rem 0.8rem;
            display: inline-block;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .address-field {
            margin-bottom: 1rem;
            position: relative;
            padding-left: 1.5rem;
        }

        .address-field::before {
            content: '‚Üí';
            position: absolute;
            left: 0;
            color: var(--accent);
            font-weight: 700;
        }

        .label {
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--earth);
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .value {
            font-size: 1.1rem;
            color: var(--ink);
            line-height: 1.4;
        }

        .copy-btn {
            margin-top: 1.5rem;
            width: 100%;
            padding: 0.75rem;
            font-size: 0.8rem;
            background: transparent;
            color: var(--earth);
            border: 2px solid var(--clay);
        }

        .copy-btn:hover {
            background: var(--clay);
            color: var(--paper);
        }

        .copied {
            animation: pulse 0.4s ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .count-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .count-control input {
            width: 80px;
            padding: 1rem;
            border: 2px solid var(--earth);
            background: var(--paper);
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            text-align: center;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            .container {
                padding: 2rem 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            .grid {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            .custom-select {
                max-width: 100%;
            }

            button {
                width: 100%;
            }
        }

        /* API Config Panel */
        .api-config {
            margin-bottom: 2rem;
            animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.15s both;
        }

        .api-toggle {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            color: var(--earth);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border: none;
            background: none;
            font-weight: 700;
            transition: color 0.3s;
        }

        .api-toggle:hover {
            color: var(--terracotta);
        }

        .api-toggle::before {
            display: none;
        }

        .api-panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.16, 1, 0.3, 1), padding 0.4s;
            background: var(--sand);
            border: 2px solid transparent;
        }

        .api-panel.open {
            max-height: 200px;
            padding: 1.25rem;
            border-color: var(--clay);
        }

        .api-panel-inner {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .api-panel input[type="text"] {
            flex: 1;
            min-width: 200px;
            padding: 0.75rem 1rem;
            border: 2px solid var(--earth);
            background: var(--paper);
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            color: var(--ink);
        }

        .api-panel input[type="text"]::placeholder {
            color: var(--clay);
        }

        .api-panel input[type="text"]:focus {
            outline: none;
            border-color: var(--terracotta);
        }

        .api-save-btn {
            padding: 0.75rem 1.25rem;
            font-size: 0.75rem;
        }

        .api-status {
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            color: var(--earth);
            width: 100%;
            margin-top: 0.5rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-dot.api {
            background: #4CAF50;
            box-shadow: 0 0 6px #4CAF50;
        }

        .status-dot.local {
            background: var(--terracotta);
            box-shadow: 0 0 6px var(--terracotta);
        }

        .status-dot.error {
            background: #e74c3c;
            box-shadow: 0 0 6px #e74c3c;
        }

        /* Name field in cards */
        .name-source-tag {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            padding: 0.2rem 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            display: inline-block;
            margin-left: 0.5rem;
            vertical-align: middle;
        }

        .name-source-tag.api {
            background: #4CAF50;
            color: white;
        }

        .name-source-tag.local {
            background: var(--clay);
            color: var(--paper);
        }

        .decorative-corner {
            position: fixed;
            width: 300px;
            height: 300px;
            border: 2px solid var(--clay);
            opacity: 0.3;
            pointer-events: none;
            z-index: 0;
        }

        .corner-tl {
            top: -150px;
            left: -150px;
            transform: rotate(45deg);
        }

        .corner-br {
            bottom: -150px;
            right: -150px;
            transform: rotate(45deg);
        }

        /* Scrollbar styling */
        .select-dropdown::-webkit-scrollbar {
            width: 10px;
        }

        .select-dropdown::-webkit-scrollbar-track {
            background: var(--sand);
        }

        .select-dropdown::-webkit-scrollbar-thumb {
            background: var(--clay);
            border: 2px solid var(--sand);
        }

        .select-dropdown::-webkit-scrollbar-thumb:hover {
            background: var(--terracotta);
        }
    </style>
</head>
<body>
    <div class="decorative-corner corner-tl"></div>
    <div class="decorative-corner corner-br"></div>

    <div class="container">
        <header>
            <h1>Global<br>Address<br>Generator</h1>
            <p class="subtitle">Direcciones aleatorias realistas de todo el mundo</p>
        </header>

        <div class="api-config">
            <button class="api-toggle" onclick="toggleApiPanel()">
                <span id="apiToggleArrow">&#9654;</span> Configurar API de nombres (Randommer.io)
            </button>
            <div class="api-panel" id="apiPanel">
                <div class="api-panel-inner">
                    <input type="text" id="apiKeyInput" placeholder="Tu API Key de randommer.io (opcional)">
                    <button class="api-save-btn" onclick="saveApiKey()"><span>Guardar</span></button>
                </div>
                <div class="api-status" id="apiStatus">
                    <span class="status-dot local"></span>
                    <span>Modo local ‚Äî Los nombres se generan proceduralmente</span>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="custom-select" id="countrySelect">
                <div class="select-trigger">
                    <div class="select-trigger-content">
                        <span class="selected-flag">üåé</span>
                        <span class="selected-label">Selecciona un pa√≠s</span>
                    </div>
                    <span class="select-arrow">‚ñº</span>
                </div>
                <div class="select-dropdown">
                    <div class="select-search">
                        <input type="text" placeholder="Buscar pa√≠s..." id="countrySearch">
                    </div>
                    <div class="select-options" id="countryOptions"></div>
                </div>
            </div>

            <div class="count-control">
                <input type="number" id="count" min="1" max="10" value="3">
                <span style="font-family: 'Space Mono', monospace; font-size: 0.8rem; color: var(--earth);">direcciones</span>
            </div>

            <button id="generate" class="primary">
                <span>Generar</span>
            </button>

            <button id="copyAll">
                <span>Copiar Todas</span>
            </button>
        </div>

        <div class="grid" id="addressGrid"></div>
    </div>

    <script>
        // ============================================
        // HYBRID NAME GENERATION SERVICE
        // Primary: Randommer.io API
        // Fallback: Procedural generation
        // ============================================

        const NameService = {
            apiKey: localStorage.getItem('randommer_api_key') || '',
            nameCache: [],
            dailyCount: parseInt(localStorage.getItem('randommer_daily_count') || '0'),
            dailyDate: localStorage.getItem('randommer_daily_date') || '',
            lastSource: 'local',
            DAILY_LIMIT: 950, // Stay under 1000 to be safe

            // Procedural name database by region
            proceduralNames: {
                'Am√©rica': {
                    first: ['Carlos', 'Mar√≠a', 'Jos√©', 'Ana', 'Luis', 'Laura', 'Miguel', 'Carmen', 'Diego', 'Sof√≠a', 'Andr√©s', 'Valentina', 'Fernando', 'Gabriela', 'Ricardo', 'Isabella', 'Alejandro', 'Daniela', 'Roberto', 'Camila', 'Jorge', 'Luc√≠a', 'Francisco', 'Mariana', 'Eduardo', 'Natalia', 'Santiago', 'Paula', 'Emilio', 'Catalina'],
                    last: ['Garc√≠a', 'Rodr√≠guez', 'Mart√≠nez', 'L√≥pez', 'Gonz√°lez', 'Hern√°ndez', 'P√©rez', 'S√°nchez', 'Ram√≠rez', 'Torres', 'Flores', 'Rivera', 'Morales', 'Reyes', 'Cruz', 'Ruiz', 'Vargas', 'Castillo', 'Medina', 'Romero']
                },
                'Am√©rica_en': {
                    first: ['James', 'Mary', 'John', 'Patricia', 'Robert', 'Jennifer', 'Michael', 'Linda', 'William', 'Elizabeth', 'David', 'Barbara', 'Richard', 'Susan', 'Thomas', 'Jessica', 'Daniel', 'Sarah', 'Matthew', 'Karen', 'Andrew', 'Emily', 'Christopher', 'Amanda', 'Brian', 'Melissa', 'Kevin', 'Stephanie', 'Jason', 'Nicole'],
                    last: ['Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis', 'Rodriguez', 'Martinez', 'Wilson', 'Anderson', 'Taylor', 'Thomas', 'Moore', 'Jackson', 'Martin', 'Lee', 'Thompson', 'White']
                },
                'Am√©rica_br': {
                    first: ['Jo√£o', 'Maria', 'Pedro', 'Ana', 'Lucas', 'Juliana', 'Gabriel', 'Fernanda', 'Rafael', 'Beatriz', 'Matheus', 'Larissa', 'Gustavo', 'Camila', 'Felipe', 'Let√≠cia', 'Bruno', 'Amanda', 'Thiago', 'Carolina'],
                    last: ['Silva', 'Santos', 'Oliveira', 'Souza', 'Rodrigues', 'Ferreira', 'Alves', 'Pereira', 'Lima', 'Gomes', 'Costa', 'Ribeiro', 'Martins', 'Carvalho', 'Ara√∫jo', 'Melo', 'Barbosa', 'Nascimento', 'Moreira', 'Nunes']
                },
                'Europa': {
                    first: ['Hans', 'Sophie', 'Pierre', 'Marie', 'Giovanni', 'Chiara', 'Erik', 'Ingrid', 'Dimitri', 'Elena', 'Klaus', 'Helga', 'Jean', 'Isabelle', 'Marco', 'Francesca', 'Stefan', 'Anna', 'Willem', 'Katrina', 'Oliver', 'Emma', 'Luca', 'Marta', 'Felix', 'Nora', 'Anton', 'Clara', 'Max', 'Lea'],
                    last: ['M√ºller', 'Schmidt', 'Dupont', 'Martin', 'Rossi', 'Bianchi', 'Johansson', 'Andersson', 'Petrov', 'Ivanov', 'Weber', 'Fischer', 'Bernard', 'Dubois', 'Romano', 'Ferrari', 'Nielsen', 'Larsen', 'De Vries', 'Bakker']
                },
                'Europa_es': {
                    first: ['Pablo', 'Luc√≠a', 'Hugo', 'Martina', '√Ålvaro', 'Sof√≠a', 'Daniel', 'Valeria', 'Adri√°n', 'Carmen', 'Sergio', 'Irene', 'David', 'Sara', 'Marcos', 'Claudia', 'Mario', 'Elena', 'Iker', 'Nerea'],
                    last: ['Garc√≠a', 'Fern√°ndez', 'Gonz√°lez', 'Rodr√≠guez', 'L√≥pez', 'Mart√≠nez', 'S√°nchez', 'P√©rez', 'G√≥mez', 'Mart√≠n', 'Ruiz', 'D√≠az', 'Hern√°ndez', '√Ålvarez', 'Moreno', 'Mu√±oz', 'Alonso', 'Jim√©nez', 'Romero', 'Navarro']
                },
                'Europa_fr': {
                    first: ['Lucas', 'Emma', 'Louis', 'Jade', 'Gabriel', 'Louise', 'Rapha√´l', 'Alice', 'Arthur', 'Chlo√©', 'Jules', 'L√©a', 'Hugo', 'Manon', 'Adam', 'In√®s', 'L√©o', 'Camille', 'Nathan', 'Sarah'],
                    last: ['Martin', 'Bernard', 'Dubois', 'Thomas', 'Robert', 'Richard', 'Petit', 'Durand', 'Leroy', 'Moreau', 'Simon', 'Laurent', 'Lefebvre', 'Michel', 'Garcia', 'David', 'Bertrand', 'Roux', 'Vincent', 'Fournier']
                },
                'Europa_it': {
                    first: ['Francesco', 'Giulia', 'Alessandro', 'Chiara', 'Lorenzo', 'Sara', 'Andrea', 'Francesca', 'Matteo', 'Anna', 'Luca', 'Valentina', 'Marco', 'Elisa', 'Davide', 'Martina', 'Federico', 'Alessia', 'Simone', 'Elena'],
                    last: ['Rossi', 'Russo', 'Ferrari', 'Esposito', 'Bianchi', 'Romano', 'Colombo', 'Ricci', 'Marino', 'Greco', 'Bruno', 'Gallo', 'Conti', 'De Luca', 'Mancini', 'Costa', 'Giordano', 'Rizzo', 'Lombardi', 'Moretti']
                },
                'Europa_de': {
                    first: ['Ben', 'Mia', 'Paul', 'Emma', 'Leon', 'Hannah', 'Finn', 'Sophia', 'Lukas', 'Anna', 'Jonas', 'Lena', 'Felix', 'Marie', 'Noah', 'Clara', 'Elias', 'Lea', 'Luis', 'Emilia'],
                    last: ['M√ºller', 'Schmidt', 'Schneider', 'Fischer', 'Weber', 'Meyer', 'Wagner', 'Becker', 'Schulz', 'Hoffmann', 'Koch', 'Richter', 'Wolf', 'Schr√∂der', 'Neumann', 'Schwarz', 'Braun', 'Zimmermann', 'Kr√ºger', 'Hartmann']
                },
                'Europa_pt': {
                    first: ['Tiago', 'Maria', 'Diogo', 'Ana', 'Gon√ßalo', 'In√™s', 'Rodrigo', 'Beatriz', 'Francisco', 'Leonor', 'Tom√°s', 'Mariana', 'Miguel', 'Carolina', 'Afonso', 'Matilde', 'Pedro', 'Sofia', 'Bernardo', 'Madalena'],
                    last: ['Silva', 'Santos', 'Ferreira', 'Pereira', 'Oliveira', 'Costa', 'Rodrigues', 'Martins', 'Sousa', 'Fernandes', 'Gon√ßalves', 'Gomes', 'Lopes', 'Marques', 'Alves', 'Almeida', 'Ribeiro', 'Pinto', 'Carvalho', 'Teixeira']
                },
                'Europa_uk': {
                    first: ['Oliver', 'Olivia', 'George', 'Amelia', 'Harry', 'Isla', 'Noah', 'Ava', 'Jack', 'Emily', 'Leo', 'Mia', 'Oscar', 'Grace', 'Charlie', 'Sophia', 'Arthur', 'Lily', 'Henry', 'Ella'],
                    last: ['Smith', 'Jones', 'Williams', 'Taylor', 'Brown', 'Davies', 'Evans', 'Wilson', 'Thomas', 'Roberts', 'Johnson', 'Lewis', 'Walker', 'Robinson', 'Wood', 'Thompson', 'White', 'Watson', 'Jackson', 'Wright']
                },
                'Asia-Ocean√≠a': {
                    first: ['Yuki', 'Hana', 'Wei', 'Mei', 'Jin', 'Sakura', 'Ryu', 'Aiko', 'Chen', 'Ling', 'Raj', 'Priya', 'Arjun', 'Sari', 'Kenji', 'Yuna', 'Hiroshi', 'Suki', 'Min', 'Lotus', 'Akira', 'Nari', 'Takeshi', 'Aya', 'Vikram', 'Ananya', 'Daisuke', 'Noor', 'Haruki', 'Kaede'],
                    last: ['Tanaka', 'Wang', 'Kim', 'Suzuki', 'Singh', 'Patel', 'Nguyen', 'Yamamoto', 'Li', 'Zhang', 'Sato', 'Chen', 'Park', 'Watanabe', 'Kumar', 'Shah', 'Tran', 'Takahashi', 'Lee', 'Nakamura']
                },
                'Asia-Ocean√≠a_au': {
                    first: ['Jack', 'Charlotte', 'Oliver', 'Olivia', 'William', 'Amelia', 'Noah', 'Mia', 'James', 'Ava', 'Thomas', 'Grace', 'Ethan', 'Lily', 'Lucas', 'Chloe', 'Henry', 'Sophie', 'Liam', 'Emma'],
                    last: ['Smith', 'Jones', 'Williams', 'Brown', 'Wilson', 'Taylor', 'Johnson', 'White', 'Martin', 'Anderson', 'Thompson', 'Nguyen', 'Thomas', 'Walker', 'Harris', 'Lee', 'Ryan', 'Robinson', 'Kelly', 'King']
                },
                'Asia-Ocean√≠a_nz': {
                    first: ['Liam', 'Charlotte', 'Oliver', 'Isla', 'Jack', 'Amelia', 'Noah', 'Olivia', 'James', 'Ava', 'William', 'Sophie', 'Lucas', 'Emily', 'Mason', 'Mia', 'Ethan', 'Ella', 'Leo', 'Harper'],
                    last: ['Smith', 'Williams', 'Brown', 'Wilson', 'Taylor', 'Anderson', 'Thomas', 'Harris', 'Jones', 'Martin', 'Singh', 'Thompson', 'Walker', 'White', 'King', 'Lee', 'Baker', 'Clark', 'Robinson', 'Campbell']
                },
                '√Åfrica-Medio Oriente': {
                    first: ['Ahmed', 'Fatima', 'Omar', 'Amina', 'Youssef', 'Layla', 'Hassan', 'Mariam', 'Ibrahim', 'Aisha', 'Ali', 'Zara', 'Mohamed', 'Nadia', 'Khalil', 'Samira', 'Tariq', 'Yasmin', 'Said', 'Halima', 'Malik', 'Safiya', 'Idris', 'Khadija', 'Rashid', 'Leila', 'Hamza', 'Soraya', 'Karim', 'Farah'],
                    last: ['Hassan', 'Ali', 'Ahmed', 'Mohamed', 'Ibrahim', 'Osman', 'Diallo', 'Mbeki', 'Nkosi', 'Abadi', 'Said', 'Saleh', 'Youssef', 'Khalil', 'Rahman', 'Mensah', 'Okafor', 'Adeyemi', 'Kamara', 'Toure']
                }
            },

            // Map country codes to specific name pools
            countryNameMap: {
                us: 'Am√©rica_en', ca: 'Am√©rica_en', pr: 'Am√©rica_en',
                br: 'Am√©rica_br',
                es: 'Europa_es',
                fr: 'Europa_fr',
                it: 'Europa_it',
                de: 'Europa_de', at: 'Europa_de', ch: 'Europa_de',
                pt: 'Europa_pt',
                uk: 'Europa_uk', ie: 'Europa_uk',
                au: 'Asia-Ocean√≠a_au',
                nz: 'Asia-Ocean√≠a_nz'
            },

            init() {
                const today = new Date().toISOString().slice(0, 10);
                if (this.dailyDate !== today) {
                    this.dailyCount = 0;
                    this.dailyDate = today;
                    localStorage.setItem('randommer_daily_count', '0');
                    localStorage.setItem('randommer_daily_date', today);
                }
                if (this.apiKey) {
                    document.getElementById('apiKeyInput').value = this.apiKey;
                }
                this.updateStatusUI();
            },

            updateStatusUI() {
                const statusEl = document.getElementById('apiStatus');
                if (!this.apiKey) {
                    statusEl.innerHTML = '<span class="status-dot local"></span><span>Modo local ‚Äî Los nombres se generan proceduralmente</span>';
                } else if (this.dailyCount >= this.DAILY_LIMIT) {
                    statusEl.innerHTML = '<span class="status-dot error"></span><span>L√≠mite diario alcanzado ‚Äî Usando fallback local (' + this.dailyCount + '/1000)</span>';
                } else {
                    statusEl.innerHTML = '<span class="status-dot api"></span><span>API activa ‚Äî Randommer.io (' + this.dailyCount + '/1000 solicitudes hoy)</span>';
                }
            },

            getNamePool(countryCode) {
                const country = addressData[countryCode];
                const specificPool = this.countryNameMap[countryCode];
                if (specificPool && this.proceduralNames[specificPool]) {
                    return this.proceduralNames[specificPool];
                }
                return this.proceduralNames[country.region] || this.proceduralNames['Am√©rica'];
            },

            generateProceduralName(countryCode) {
                const pool = this.getNamePool(countryCode);
                const first = pool.first[Math.floor(Math.random() * pool.first.length)];
                const last = pool.last[Math.floor(Math.random() * pool.last.length)];
                return { fullName: first + ' ' + last, source: 'local' };
            },

            async fetchNamesFromAPI(quantity) {
                if (!this.apiKey || this.dailyCount >= this.DAILY_LIMIT) {
                    return null;
                }

                try {
                    const response = await fetch(
                        'https://randommer.io/api/Name?nameType=fullname&quantity=' + quantity,
                        {
                            headers: {
                                'X-Api-Key': this.apiKey
                            }
                        }
                    );

                    if (response.status === 429) {
                        this.dailyCount = this.DAILY_LIMIT;
                        localStorage.setItem('randommer_daily_count', String(this.dailyCount));
                        this.updateStatusUI();
                        return null;
                    }

                    if (!response.ok) {
                        return null;
                    }

                    const names = await response.json();
                    this.dailyCount += 1;
                    localStorage.setItem('randommer_daily_count', String(this.dailyCount));
                    this.updateStatusUI();
                    return names;
                } catch (err) {
                    console.warn('Randommer API error, using fallback:', err.message);
                    return null;
                }
            },

            async getNames(countryCode, quantity) {
                // Try API first
                const apiNames = await this.fetchNamesFromAPI(quantity);
                if (apiNames && apiNames.length > 0) {
                    this.lastSource = 'api';
                    return apiNames.map(name => ({ fullName: name, source: 'api' }));
                }

                // Fallback to procedural
                this.lastSource = 'local';
                const names = [];
                for (let i = 0; i < quantity; i++) {
                    names.push(this.generateProceduralName(countryCode));
                }
                return names;
            }
        };

        // Massive address database
        const addressData = {
            // AM√âRICA
            ar: { name: 'Argentina', flag: 'üá¶üá∑', region: 'Am√©rica', streets: ['Av. Corrientes', 'Av. Santa Fe', 'Calle Florida', 'Av. 9 de Julio', 'Av. Callao', 'Av. Rivadavia'], cities: ['Buenos Aires', 'C√≥rdoba', 'Rosario', 'Mendoza', 'La Plata', 'San Miguel de Tucum√°n'], states: ['Buenos Aires', 'C√≥rdoba', 'Santa Fe', 'Mendoza', 'Buenos Aires', 'Tucum√°n'], postalPrefix: [1000, 5000, 2000, 5500, 1900, 4000] },
            br: { name: 'Brasil', flag: 'üáßüá∑', region: 'Am√©rica', streets: ['Av. Paulista', 'Rua Augusta', 'Av. Faria Lima', 'Rua Oscar Freire', 'Av. Brigadeiro'], cities: ['S√£o Paulo', 'Rio de Janeiro', 'Bras√≠lia', 'Salvador', 'Fortaleza'], states: ['S√£o Paulo', 'Rio de Janeiro', 'Distrito Federal', 'Bahia', 'Cear√°'], postalPrefix: [01310, 20000, 70000, 40000, 60000] },
            ca: { name: 'Canad√°', flag: 'üá®üá¶', region: 'Am√©rica', streets: ['Yonge Street', 'Queen Street', 'Robson Street', 'Sainte-Catherine', 'King Street'], cities: ['Toronto', 'Vancouver', 'Montreal', 'Calgary', 'Ottawa'], states: ['Ontario', 'British Columbia', 'Quebec', 'Alberta', 'Ontario'], postalPrefix: ['M5H', 'V6B', 'H3B', 'T2P', 'K1A'] },
            cl: { name: 'Chile', flag: 'üá®üá±', region: 'Am√©rica', streets: ['Av. Libertador', 'Av. Providencia', 'Av. Apoquindo', 'Calle Hu√©rfanos', 'Av. Vicu√±a Mackenna'], cities: ['Santiago', 'Valpara√≠so', 'Concepci√≥n', 'La Serena', 'Antofagasta'], states: ['Regi√≥n Metropolitana', 'Valpara√≠so', 'Biob√≠o', 'Coquimbo', 'Antofagasta'], postalPrefix: [833, 234, 407, 170, 124] },
            co: { name: 'Colombia', flag: 'üá®üá¥', region: 'Am√©rica', streets: ['Carrera 7', 'Calle 100', 'Av. Caracas', 'Calle 72', 'Carrera 15'], cities: ['Bogot√°', 'Medell√≠n', 'Cali', 'Barranquilla', 'Cartagena'], states: ['Cundinamarca', 'Antioquia', 'Valle del Cauca', 'Atl√°ntico', 'Bol√≠var'], postalPrefix: [110, 050, 760, 080, 130] },
            cr: { name: 'Costa Rica', flag: 'üá®üá∑', region: 'Am√©rica', streets: ['Paseo Col√≥n', 'Av. Central', 'Calle Blancos', 'Av. Segunda'], cities: ['San Jos√©', 'Alajuela', 'Cartago', 'Heredia'], states: ['San Jos√©', 'Alajuela', 'Cartago', 'Heredia'], postalPrefix: [10101, 20101, 30101, 40101] },
            ec: { name: 'Ecuador', flag: 'üá™üá®', region: 'Am√©rica', streets: ['Av. Amazonas', 'Av. 6 de Diciembre', 'Av. Gonz√°lez Su√°rez', 'Av. 10 de Agosto'], cities: ['Quito', 'Guayaquil', 'Cuenca'], states: ['Pichincha', 'Guayas', 'Azuay'], postalPrefix: [170143, 090150, 010150] },
            us: { name: 'Estados Unidos', flag: 'üá∫üá∏', region: 'Am√©rica', streets: ['Main Street', 'Oak Avenue', 'Maple Drive', 'Park Boulevard', 'Washington Street', 'Lincoln Avenue'], cities: ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix', 'Miami', 'Seattle', 'Denver', 'Boston', 'Atlanta', 'San Francisco', 'Dallas', 'Philadelphia', 'Las Vegas', 'Portland', 'San Diego', 'Austin', 'Nashville', 'Ashburn'], states: ['NY', 'CA', 'IL', 'TX', 'AZ', 'FL', 'WA', 'CO', 'MA', 'GA', 'CA', 'TX', 'PA', 'NV', 'OR', 'CA', 'TX', 'TN', 'VA'], postalPrefix: [100, 900, 606, 770, 850, 331, 981, 802, 021, 303, 941, 752, 191, 891, 972, 920, 787, 372, 201] },
            gt: { name: 'Guatemala', flag: 'üá¨üáπ', region: 'Am√©rica', streets: ['Av. Reforma', '6a Avenida', '7a Avenida', 'Calzada Roosevelt'], cities: ['Ciudad de Guatemala', 'Antigua', 'Quetzaltenango'], states: ['Guatemala', 'Sacatep√©quez', 'Quetzaltenango'], postalPrefix: [01001, 03001, 09001] },
            hn: { name: 'Honduras', flag: 'üá≠üá≥', region: 'Am√©rica', streets: ['Blvd. Moraz√°n', 'Av. Rep√∫blica de Chile', 'Av. Juan Pablo II'], cities: ['Tegucigalpa', 'San Pedro Sula'], states: ['Francisco Moraz√°n', 'Cort√©s'], postalPrefix: [11101, 21101] },
            mx: { name: 'M√©xico', flag: 'üá≤üáΩ', region: 'Am√©rica', streets: ['Av. Insurgentes', 'Calle Ju√°rez', 'Paseo de la Reforma', 'Av. Revoluci√≥n', 'Calle Madero'], cities: ['Ciudad de M√©xico', 'Guadalajara', 'Monterrey', 'Puebla', 'Quer√©taro', 'Tijuana'], states: ['CDMX', 'Jalisco', 'Nuevo Le√≥n', 'Puebla', 'Quer√©taro', 'Baja California'], postalPrefix: [6, 44, 64, 72, 76, 22] },
            pa: { name: 'Panam√°', flag: 'üáµüá¶', region: 'Am√©rica', streets: ['V√≠a Espa√±a', 'Av. Balboa', 'Calle 50', 'Tumba Muerto'], cities: ['Ciudad de Panam√°', 'Col√≥n'], states: ['Panam√°', 'Col√≥n'], postalPrefix: [0801, 0201] },
            pe: { name: 'Per√∫', flag: 'üáµüá™', region: 'Am√©rica', streets: ['Av. Javier Prado', 'Av. Arequipa', 'Av. La Marina', 'Jr. de la Uni√≥n'], cities: ['Lima', 'Arequipa', 'Trujillo', 'Cusco'], states: ['Lima', 'Arequipa', 'La Libertad', 'Cusco'], postalPrefix: [15001, 04001, 13001, 08000] },
            pr: { name: 'Puerto Rico', flag: 'üáµüá∑', region: 'Am√©rica', streets: ['Av. Ponce de Le√≥n', 'Av. Roosevelt', 'Calle San Francisco'], cities: ['San Juan', 'Ponce', 'Mayag√ºez'], states: ['San Juan', 'Ponce', 'Mayag√ºez'], postalPrefix: [901, 717, 680] },
            do: { name: 'Rep√∫blica Dominicana', flag: 'üá©üá¥', region: 'Am√©rica', streets: ['Av. 27 de Febrero', 'Av. Winston Churchill', 'Av. Abraham Lincoln'], cities: ['Santo Domingo', 'Santiago'], states: ['Distrito Nacional', 'Santiago'], postalPrefix: [10201, 51000] },
            uy: { name: 'Uruguay', flag: 'üá∫üáæ', region: 'Am√©rica', streets: ['Av. 18 de Julio', 'Rambla Rep√∫blica', 'Av. Italia'], cities: ['Montevideo', 'Punta del Este'], states: ['Montevideo', 'Maldonado'], postalPrefix: [11100, 20100] },
            ve: { name: 'Venezuela', flag: 'üáªüá™', region: 'Am√©rica', streets: ['Av. Libertador', 'Av. Francisco de Miranda', 'Av. Urdaneta'], cities: ['Caracas', 'Maracaibo', 'Valencia'], states: ['Distrito Capital', 'Zulia', 'Carabobo'], postalPrefix: [1010, 4001, 2001] },
            
            // EUROPA
            at: { name: 'Austria', flag: 'üá¶üáπ', region: 'Europa', streets: ['K√§rntner Stra√üe', 'Mariahilfer Stra√üe', 'Ringstra√üe'], cities: ['Viena', 'Salzburgo', 'Innsbruck'], states: ['Wien', 'Salzburg', 'Tirol'], postalPrefix: [1010, 5020, 6020] },
            be: { name: 'B√©lgica', flag: 'üáßüá™', region: 'Europa', streets: ['Avenue Louise', 'Rue Neuve', 'Boulevard Anspach'], cities: ['Bruselas', 'Amberes', 'Gante'], states: ['Bruxelles', 'Antwerpen', 'Gent'], postalPrefix: [1000, 2000, 9000] },
            bg: { name: 'Bulgaria', flag: 'üáßüá¨', region: 'Europa', streets: ['Vitosha Boulevard', 'Graf Ignatiev Street', 'Tsar Osvoboditel Boulevard'], cities: ['Sof√≠a', 'Plovdiv', 'Varna'], states: ['Sofia', 'Plovdiv', 'Varna'], postalPrefix: [1000, 4000, 9000] },
            cz: { name: 'Chequia', flag: 'üá®üáø', region: 'Europa', streets: ['V√°clavsk√© n√°mƒõst√≠', 'Na P≈ô√≠kopƒõ', 'Pa≈ô√≠≈æsk√°'], cities: ['Praga', 'Brno', 'Ostrava'], states: ['Praha', 'Brno', 'Ostrava'], postalPrefix: [110, 602, 702] },
            dk: { name: 'Dinamarca', flag: 'üá©üá∞', region: 'Europa', streets: ['Str√∏get', 'N√∏rrebrogade', 'Vesterbrogade'], cities: ['Copenhague', 'Aarhus', 'Odense'], states: ['K√∏benhavn', 'Aarhus', 'Odense'], postalPrefix: [1050, 8000, 5000] },
            sk: { name: 'Eslovaquia', flag: 'üá∏üá∞', region: 'Europa', streets: ['Hviezdoslavovo n√°mestie', 'Obchodn√° ulica', 'Laurinsk√°'], cities: ['Bratislava', 'Ko≈°ice'], states: ['Bratislava', 'Ko≈°ice'], postalPrefix: [811, 040] },
            si: { name: 'Eslovenia', flag: 'üá∏üáÆ', region: 'Europa', streets: ['Slovenska cesta', 'ƒåopova ulica', 'Trubarjeva cesta'], cities: ['Liubliana', 'Maribor'], states: ['Ljubljana', 'Maribor'], postalPrefix: [1000, 2000] },
            es: { name: 'Espa√±a', flag: 'üá™üá∏', region: 'Europa', streets: ['Gran V√≠a', 'Paseo de Gracia', 'Calle Alcal√°', 'Paseo del Prado', 'Rambla Catalunya'], cities: ['Madrid', 'Barcelona', 'Valencia', 'Sevilla', 'Zaragoza', 'M√°laga'], states: ['Madrid', 'Barcelona', 'Valencia', 'Sevilla', 'Zaragoza', 'M√°laga'], postalPrefix: [280, 80, 460, 410, 500, 290] },
            ee: { name: 'Estonia', flag: 'üá™üá™', region: 'Europa', streets: ['Narva maantee', 'P√§rnu maantee', 'Viru v√§ljak'], cities: ['Tallin', 'Tartu'], states: ['Harju', 'Tartu'], postalPrefix: [10120, 50090] },
            fi: { name: 'Finlandia', flag: 'üá´üáÆ', region: 'Europa', streets: ['Mannerheimintie', 'Aleksanterinkatu', 'Esplanadi'], cities: ['Helsinki', 'Espoo', 'Tampere'], states: ['Uusimaa', 'Uusimaa', 'Pirkanmaa'], postalPrefix: [100, 2100, 33100] },
            fr: { name: 'Francia', flag: 'üá´üá∑', region: 'Europa', streets: ['Avenue des Champs-√âlys√©es', 'Boulevard Haussmann', 'Rue de Rivoli', 'Avenue Montaigne'], cities: ['Par√≠s', 'Marsella', 'Lyon', 'Toulouse', 'Nice'], states: ['√éle-de-France', 'Bouches-du-Rh√¥ne', 'Rh√¥ne', 'Haute-Garonne', 'Alpes-Maritimes'], postalPrefix: [750, 130, 690, 310, 60] },
            gr: { name: 'Grecia', flag: 'üá¨üá∑', region: 'Europa', streets: ['Ermou Street', 'Stadiou Street', 'Panepistimiou Avenue'], cities: ['Atenas', 'Sal√≥nica', 'Patras'], states: ['Attica', 'Central Macedonia', 'West Greece'], postalPrefix: [105, 546, 262] },
            hu: { name: 'Hungr√≠a', flag: 'üá≠üá∫', region: 'Europa', streets: ['Andr√°ssy √∫t', 'V√°ci utca', 'R√°k√≥czi √∫t'], cities: ['Budapest', 'Debrecen', 'Szeged'], states: ['Budapest', 'Hajd√∫-Bihar', 'Csongr√°d'], postalPrefix: [1051, 4024, 6720] },
            ie: { name: 'Irlanda', flag: 'üáÆüá™', region: 'Europa', streets: ["O'Connell Street", 'Grafton Street', 'Henry Street'], cities: ['Dubl√≠n', 'Cork', 'Galway'], states: ['Dublin', 'Cork', 'Galway'], postalPrefix: ['D01', 'T12', 'H91'] },
            is: { name: 'Islandia', flag: 'üáÆüá∏', region: 'Europa', streets: ['Laugavegur', 'Sk√≥lav√∂r√∞ust√≠gur', 'Hverfisgata'], cities: ['Reikiavik', 'K√≥pavogur'], states: ['Reykjav√≠k', 'K√≥pavogur'], postalPrefix: [101, 200] },
            it: { name: 'Italia', flag: 'üáÆüáπ', region: 'Europa', streets: ['Via del Corso', 'Via Tornabuoni', 'Via Montenapoleone', 'Via Condotti'], cities: ['Roma', 'Mil√°n', 'N√°poles', 'Tur√≠n', 'Florencia', 'Venecia'], states: ['Lazio', 'Lombardia', 'Campania', 'Piemonte', 'Toscana', 'Veneto'], postalPrefix: [185, 201, 801, 101, 501, 301] },
            lv: { name: 'Letonia', flag: 'üá±üáª', region: 'Europa', streets: ['Brƒ´vƒ´bas iela', 'Elizabetes iela', 'Kr. Barona iela'], cities: ['Riga', 'Daugavpils'], states: ['Rƒ´ga', 'Daugavpils'], postalPrefix: [1010, 5401] },
            lt: { name: 'Lituania', flag: 'üá±üáπ', region: 'Europa', streets: ['Gedimino prospektas', 'Pilies gatvƒó', 'Vilniaus gatvƒó'], cities: ['Vilna', 'Kaunas'], states: ['Vilnius', 'Kaunas'], postalPrefix: [1010, 44001] },
            lu: { name: 'Luxemburgo', flag: 'üá±üá∫', region: 'Europa', streets: ['Avenue de la Libert√©', 'Grand Rue', 'Avenue Monterey'], cities: ['Luxemburgo', 'Esch-sur-Alzette'], states: ['Luxembourg', 'Esch-sur-Alzette'], postalPrefix: [1000, 4000] },
            no: { name: 'Noruega', flag: 'üá≥üá¥', region: 'Europa', streets: ['Karl Johans gate', 'Grensen', 'Storgata'], cities: ['Oslo', 'Bergen', 'Trondheim'], states: ['Oslo', 'Vestland', 'Tr√∏ndelag'], postalPrefix: [150, 5003, 7010] },
            nl: { name: 'Pa√≠ses Bajos', flag: 'üá≥üá±', region: 'Europa', streets: ['Kalverstraat', 'Leidsestraat', 'Damrak'], cities: ['√Åmsterdam', 'R√≥terdam', 'La Haya'], states: ['Noord-Holland', 'Zuid-Holland', 'Zuid-Holland'], postalPrefix: [1012, 3011, 2511] },
            pl: { name: 'Polonia', flag: 'üáµüá±', region: 'Europa', streets: ['Nowy ≈öwiat', 'Krakowskie Przedmie≈õcie', 'Marsza≈Çkowska'], cities: ['Varsovia', 'Cracovia', 'Wroclaw'], states: ['Mazowieckie', 'Ma≈Çopolskie', 'Dolno≈õlƒÖskie'], postalPrefix: [0, 30, 50] },
            pt: { name: 'Portugal', flag: 'üáµüáπ', region: 'Europa', streets: ['Avenida da Liberdade', 'Rua Augusta', 'Rua de Santa Catarina'], cities: ['Lisboa', 'Oporto', 'Braga'], states: ['Lisboa', 'Porto', 'Braga'], postalPrefix: [1050, 4000, 4700] },
            uk: { name: 'Reino Unido', flag: 'üá¨üáß', region: 'Europa', streets: ['Oxford Street', 'Regent Street', 'Piccadilly', 'Bond Street'], cities: ['Londres', 'Manchester', 'Birmingham', 'Glasgow', 'Liverpool', 'Edimburgo'], states: ['Greater London', 'Greater Manchester', 'West Midlands', 'Glasgow', 'Merseyside', 'Edinburgh'], postalPrefix: ['W1', 'M1', 'B1', 'G1', 'L1', 'EH1'] },
            ro: { name: 'Rumania', flag: 'üá∑üá¥', region: 'Europa', streets: ['Calea Victoriei', 'Strada Lipscani', 'Bulevardul Unirii'], cities: ['Bucarest', 'Cluj-Napoca', 'Timi»ôoara'], states: ['Bucure»ôti', 'Cluj', 'Timi»ô'], postalPrefix: [10101, 400001, 300001] },
            se: { name: 'Suecia', flag: 'üá∏üá™', region: 'Europa', streets: ['Drottninggatan', 'Sveav√§gen', 'Hamngatan'], cities: ['Estocolmo', 'Gotemburgo', 'Malm√∂'], states: ['Stockholm', 'V√§stra G√∂taland', 'Sk√•ne'], postalPrefix: [111, 411, 211] },
            ch: { name: 'Suiza', flag: 'üá®üá≠', region: 'Europa', streets: ['Bahnhofstrasse', 'Rue du Rh√¥ne', 'Paradeplatz'], cities: ['Z√∫rich', 'Ginebra', 'Basilea', 'Berna', 'Lausana'], states: ['Z√ºrich', 'Gen√®ve', 'Basel-Stadt', 'Bern', 'Vaud'], postalPrefix: [8001, 1201, 4001, 3001, 1003] },
            ua: { name: 'Ucrania', flag: 'üá∫üá¶', region: 'Europa', streets: ['Khreshchatyk Street', 'Andriyivskyy Descent', 'Velyka Vasylkivska Street'], cities: ['Kiev', 'J√°rkov', 'Odesa'], states: ['Kyiv', 'Kharkiv', 'Odesa'], postalPrefix: [1001, 61001, 65001] },
            de: { name: 'Alemania', flag: 'üá©üá™', region: 'Europa', streets: ['Kurf√ºrstendamm', 'Unter den Linden', 'K√∂nigsallee', 'Maximilianstra√üe'], cities: ['Frankfurt', 'Berl√≠n', 'M√∫nich', 'Hamburgo', 'Colonia', 'Stuttgart'], states: ['Hessen', 'Berlin', 'Bayern', 'Hamburg', 'Nordrhein-Westfalen', 'Baden-W√ºrttemberg'], postalPrefix: [600, 100, 800, 200, 500, 700] },
            
            // ASIA Y OCEAN√çA
            au: { name: 'Australia', flag: 'üá¶üá∫', region: 'Asia-Ocean√≠a', streets: ['George Street', 'Collins Street', 'Queen Street', 'King Street'], cities: ['S√≠dney', 'Melbourne', 'Brisbane', 'Perth', 'Adelaida'], states: ['NSW', 'VIC', 'QLD', 'WA', 'SA'], postalPrefix: [2000, 3000, 4000, 6000, 5000] },
            kh: { name: 'Camboya', flag: 'üá∞üá≠', region: 'Asia-Ocean√≠a', streets: ['Monivong Boulevard', 'Norodom Boulevard', 'Street 240'], cities: ['Phnom Penh', 'Siem Reap'], states: ['Phnom Penh', 'Siem Reap'], postalPrefix: [12301, 17251] },
            kr: { name: 'Corea del Sur', flag: 'üá∞üá∑', region: 'Asia-Ocean√≠a', streets: ['Gangnam-daero', 'Teheran-ro', 'Sejong-daero'], cities: ['Se√∫l', 'Busan', 'Incheon'], states: ['Seoul', 'Busan', 'Incheon'], postalPrefix: [6001, 48001, 21501] },
            ae: { name: 'Emiratos √Årabes', flag: 'üá¶üá™', region: 'Asia-Ocean√≠a', streets: ['Sheikh Zayed Road', 'Jumeirah Beach Road', 'Al Maktoum Road'], cities: ['Dub√°i', 'Abu Dhabi'], states: ['Dubai', 'Abu Dhabi'], postalPrefix: [0, 0] },
            ph: { name: 'Filipinas', flag: 'üáµüá≠', region: 'Asia-Ocean√≠a', streets: ['EDSA', 'Ayala Avenue', 'Roxas Boulevard'], cities: ['Manila', 'Quezon City', 'Makati'], states: ['Metro Manila', 'Metro Manila', 'Metro Manila'], postalPrefix: [1000, 1100, 1200] },
            hk: { name: 'Hong Kong', flag: 'üá≠üá∞', region: 'Asia-Ocean√≠a', streets: ['Nathan Road', 'Queen\'s Road', 'Des Voeux Road'], cities: ['Hong Kong'], states: ['Hong Kong Island'], postalPrefix: [0] },
            in: { name: 'India', flag: 'üáÆüá≥', region: 'Asia-Ocean√≠a', streets: ['MG Road', 'Commercial Street', 'Brigade Road'], cities: ['Bombay', 'Delhi', 'Bangalore'], states: ['Maharashtra', 'Delhi', 'Karnataka'], postalPrefix: [400001, 110001, 560001] },
            id: { name: 'Indonesia', flag: 'üáÆüá©', region: 'Asia-Ocean√≠a', streets: ['Jalan Thamrin', 'Jalan Sudirman', 'Jalan Gatot Subroto'], cities: ['Yakarta', 'Surabaya', 'Bandung'], states: ['Jakarta', 'East Java', 'West Java'], postalPrefix: [10110, 60111, 40111] },
            jp: { name: 'Jap√≥n', flag: 'üáØüáµ', region: 'Asia-Ocean√≠a', streets: ['Shibuya Crossing', 'Ginza Dori', 'Shinjuku Dori', 'Omotesando'], cities: ['Tokio', 'Osaka', 'Kioto', 'Yokohama', 'Nagoya', 'Sapporo'], states: ['Tokyo', 'Osaka', 'Kyoto', 'Kanagawa', 'Aichi', 'Hokkaido'], postalPrefix: [100, 530, 600, 220, 450, 60] },
            kz: { name: 'Kazajist√°n', flag: 'üá∞üáø', region: 'Asia-Ocean√≠a', streets: ['Abay Avenue', 'Dostyk Avenue', 'Furmanov Street'], cities: ['Almaty', 'Nur-Sultan'], states: ['Almaty', 'Nur-Sultan'], postalPrefix: [50000, 10000] },
            my: { name: 'Malasia', flag: 'üá≤üáæ', region: 'Asia-Ocean√≠a', streets: ['Jalan Bukit Bintang', 'Jalan Ampang', 'Jalan Raja Chulan'], cities: ['Kuala Lumpur', 'Penang', 'Johor Bahru'], states: ['Kuala Lumpur', 'Penang', 'Johor'], postalPrefix: [50000, 10000, 80000] },
            nz: { name: 'Nueva Zelanda', flag: 'üá≥üáø', region: 'Asia-Ocean√≠a', streets: ['Queen Street', 'Lambton Quay', 'Cashel Street'], cities: ['Auckland', 'Wellington', 'Christchurch'], states: ['Auckland', 'Wellington', 'Canterbury'], postalPrefix: [1010, 6011, 8011] },
            pk: { name: 'Pakist√°n', flag: 'üáµüá∞', region: 'Asia-Ocean√≠a', streets: ['Mall Road', 'Shahrah-e-Faisal', 'Jinnah Avenue'], cities: ['Karachi', 'Lahore', 'Islamabad'], states: ['Sindh', 'Punjab', 'Islamabad Capital Territory'], postalPrefix: [75500, 54000, 44000] },
            sg: { name: 'Singapur', flag: 'üá∏üá¨', region: 'Asia-Ocean√≠a', streets: ['Orchard Road', 'Marina Bay', 'Raffles Place'], cities: ['Singapur'], states: ['Central Region'], postalPrefix: [238801] },
            tw: { name: 'Taiw√°n', flag: 'üáπüáº', region: 'Asia-Ocean√≠a', streets: ['Zhongxiao East Road', 'Xinyi Road', 'Dunhua South Road'], cities: ['Taip√©i', 'Kaohsiung', 'Taichung'], states: ['Taipei City', 'Kaohsiung City', 'Taichung City'], postalPrefix: [100, 800, 400] },
            th: { name: 'Tailandia', flag: 'üáπüá≠', region: 'Asia-Ocean√≠a', streets: ['Sukhumvit Road', 'Silom Road', 'Ratchadamri Road'], cities: ['Bangkok', 'Chiang Mai', 'Phuket'], states: ['Bangkok', 'Chiang Mai', 'Phuket'], postalPrefix: [10110, 50000, 83000] },
            vn: { name: 'Vietnam', flag: 'üáªüá≥', region: 'Asia-Ocean√≠a', streets: ['Nguyen Hue Street', 'Le Loi Boulevard', 'Dong Khoi Street'], cities: ['Ho Chi Minh', 'Han√≥i', 'Da Nang'], states: ['Ho Chi Minh City', 'Hanoi', 'Da Nang'], postalPrefix: [700000, 100000, 550000] },
            
            // √ÅFRICA Y MEDIO ORIENTE
            dz: { name: 'Argelia', flag: 'üá©üáø', region: '√Åfrica-Medio Oriente', streets: ['Rue Didouche Mourad', 'Boulevard Mohamed V', 'Rue Larbi Ben M\'hidi'], cities: ['Argel', 'Or√°n'], states: ['Algiers', 'Oran'], postalPrefix: [16000, 31000] },
            ao: { name: 'Angola', flag: 'üá¶üá¥', region: '√Åfrica-Medio Oriente', streets: ['Avenida 4 de Fevereiro', 'Rua Rainha Ginga', 'Marginal de Luanda'], cities: ['Luanda', 'Huambo'], states: ['Luanda', 'Huambo'], postalPrefix: [0, 0] },
            eg: { name: 'Egipto', flag: 'üá™üá¨', region: '√Åfrica-Medio Oriente', streets: ['Tahrir Square', 'Corniche El Nil', 'Qasr El Nil Street'], cities: ['El Cairo', 'Alejandr√≠a', 'Giza'], states: ['Cairo', 'Alexandria', 'Giza'], postalPrefix: [11511, 21500, 12511] },
            gh: { name: 'Ghana', flag: 'üá¨üá≠', region: '√Åfrica-Medio Oriente', streets: ['Oxford Street', 'Independence Avenue', 'Spintex Road'], cities: ['Accra', 'Kumasi'], states: ['Greater Accra', 'Ashanti'], postalPrefix: [0, 0] },
            il: { name: 'Israel', flag: 'üáÆüá±', region: '√Åfrica-Medio Oriente', streets: ['Rothschild Boulevard', 'Dizengoff Street', 'Ben Yehuda Street'], cities: ['Tel Aviv', 'Jerusal√©n', 'Haifa'], states: ['Tel Aviv', 'Jerusalem', 'Haifa'], postalPrefix: [61000, 91000, 31000] },
            ke: { name: 'Kenia', flag: 'üá∞üá™', region: '√Åfrica-Medio Oriente', streets: ['Moi Avenue', 'Kenyatta Avenue', 'Kimathi Street'], cities: ['Nairobi', 'Mombasa'], states: ['Nairobi', 'Mombasa'], postalPrefix: [100, 80100] },
            ma: { name: 'Marruecos', flag: 'üá≤üá¶', region: '√Åfrica-Medio Oriente', streets: ['Avenue Hassan II', 'Boulevard Mohammed V', 'Avenue des FAR'], cities: ['Casablanca', 'Rabat', 'Marrakech'], states: ['Casablanca', 'Rabat', 'Marrakech'], postalPrefix: [20000, 10000, 40000] },
            ng: { name: 'Nigeria', flag: 'üá≥üá¨', region: '√Åfrica-Medio Oriente', streets: ['Victoria Island', 'Ikoyi Road', 'Awolowo Road'], cities: ['Lagos', 'Abuja', 'Kano'], states: ['Lagos', 'Federal Capital Territory', 'Kano'], postalPrefix: [100001, 900001, 700001] },
            za: { name: 'Sud√°frica', flag: 'üáøüá¶', region: '√Åfrica-Medio Oriente', streets: ['Sandton Drive', 'Long Street', 'Nelson Mandela Boulevard'], cities: ['Johannesburgo', 'Ciudad del Cabo', 'Durban'], states: ['Gauteng', 'Western Cape', 'KwaZulu-Natal'], postalPrefix: [2000, 8001, 4001] },
            tn: { name: 'T√∫nez', flag: 'üáπüá≥', region: '√Åfrica-Medio Oriente', streets: ['Avenue Habib Bourguiba', 'Rue de Marseille', 'Avenue de la Libert√©'], cities: ['T√∫nez', 'Sfax'], states: ['Tunis', 'Sfax'], postalPrefix: [1000, 3000] },
            tr: { name: 'Turqu√≠a', flag: 'üáπüá∑', region: '√Åfrica-Medio Oriente', streets: ['ƒ∞stiklal Caddesi', 'Baƒüdat Caddesi', 'Ni≈üanta≈üƒ±'], cities: ['Estambul', 'Ankara', 'Esmirna'], states: ['Istanbul', 'Ankara', 'Izmir'], postalPrefix: [34000, 6000, 35000] }
        };

        function random(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function randomNumber(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateAddress(countryCode, nameData) {
            const country = addressData[countryCode];
            const cityIndex = Math.floor(Math.random() * country.cities.length);

            const postalCode = typeof country.postalPrefix[cityIndex] === 'string'
                ? country.postalPrefix[cityIndex] + randomNumber(100, 999).toString().substring(0, 3)
                : country.postalPrefix[cityIndex].toString().padStart(5, '0') + randomNumber(1, 99).toString().padStart(2, '0');

            return {
                country: country.name,
                flag: country.flag,
                name: nameData.fullName,
                nameSource: nameData.source,
                street: random(country.streets),
                number: randomNumber(1, 9999),
                city: country.cities[cityIndex],
                state: country.states[cityIndex],
                postal: postalCode.substring(0, 8)
            };
        }

        function createAddressCard(address, index) {
            const card = document.createElement('div');
            card.className = 'address-card';
            card.style.animationDelay = `${index * 0.1}s`;
            
            const sourceTag = address.nameSource === 'api'
                ? '<span class="name-source-tag api">API</span>'
                : '<span class="name-source-tag local">LOCAL</span>';

            card.innerHTML = `
                <div class="country-tag">${address.flag} ${address.country}</div>

                <div class="address-field">
                    <div class="label">Nombre ${sourceTag}</div>
                    <div class="value">${address.name}</div>
                </div>

                <div class="address-field">
                    <div class="label">Calle</div>
                    <div class="value">${address.street} ${address.number}</div>
                </div>
                
                <div class="address-field">
                    <div class="label">Ciudad</div>
                    <div class="value">${address.city}</div>
                </div>
                
                <div class="address-field">
                    <div class="label">Estado/Regi√≥n</div>
                    <div class="value">${address.state}</div>
                </div>
                
                <div class="address-field">
                    <div class="label">C√≥digo Postal</div>
                    <div class="value">${address.postal}</div>
                </div>
                
                <button class="copy-btn" onclick="copyAddress(this)">
                    <span>Copiar direcci√≥n</span>
                </button>
            `;
            
            return card;
        }

        let selectedCountry = 'mx';

        // Custom Select Logic
        const selectTrigger = document.querySelector('.select-trigger');
        const selectDropdown = document.querySelector('.select-dropdown');
        const selectOptions = document.getElementById('countryOptions');
        const searchInput = document.getElementById('countrySearch');
        const selectedLabel = document.querySelector('.selected-label');
        const selectedFlag = document.querySelector('.selected-flag');

        // Populate options
        const sortedCountries = Object.keys(addressData).sort((a, b) => 
            addressData[a].name.localeCompare(addressData[b].name)
        );

        function renderOptions(filter = '') {
            selectOptions.innerHTML = '';
            const filtered = sortedCountries.filter(code => 
                addressData[code].name.toLowerCase().includes(filter.toLowerCase()) ||
                addressData[code].region.toLowerCase().includes(filter.toLowerCase())
            );

            if (filtered.length === 0) {
                selectOptions.innerHTML = '<div class="no-results">No se encontraron pa√≠ses</div>';
                return;
            }

            filtered.forEach(code => {
                const country = addressData[code];
                const option = document.createElement('div');
                option.className = 'select-option' + (code === selectedCountry ? ' selected' : '');
                option.dataset.value = code;
                
                option.innerHTML = `
                    <span class="option-flag">${country.flag}</span>
                    <div class="option-content">
                        <span class="option-label">${country.name}</span>
                        <span class="option-region">${country.region}</span>
                    </div>
                `;
                
                option.addEventListener('click', () => {
                    selectedCountry = code;
                    selectedLabel.textContent = country.name;
                    selectedFlag.textContent = country.flag;
                    
                    document.querySelectorAll('.select-option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    
                    selectTrigger.classList.remove('active');
                    selectDropdown.classList.remove('active');
                });
                
                selectOptions.appendChild(option);
            });
        }

        renderOptions();

        selectTrigger.addEventListener('click', (e) => {
            e.stopPropagation();
            selectTrigger.classList.toggle('active');
            selectDropdown.classList.toggle('active');
            if (selectDropdown.classList.contains('active')) {
                searchInput.focus();
            }
        });

        searchInput.addEventListener('input', (e) => {
            renderOptions(e.target.value);
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.custom-select')) {
                selectTrigger.classList.remove('active');
                selectDropdown.classList.remove('active');
            }
        });

        // Address generation (async for API calls)
        async function generateAddresses() {
            const count = Math.min(parseInt(document.getElementById('count').value) || 3, 10);
            const grid = document.getElementById('addressGrid');

            grid.innerHTML = '<div style="font-family: Space Mono, monospace; font-size: 0.85rem; color: var(--earth); padding: 2rem;">Generando...</div>';

            const names = await NameService.getNames(selectedCountry, count);

            grid.innerHTML = '';

            for (let i = 0; i < count; i++) {
                const address = generateAddress(selectedCountry, names[i]);
                const card = createAddressCard(address, i);
                grid.appendChild(card);
            }
        }

        function copyAddress(button) {
            const card = button.closest('.address-card');
            const fields = card.querySelectorAll('.address-field .value');
            const text = Array.from(fields).map(f => f.textContent).join('\n');
            
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.innerHTML;
                button.innerHTML = '<span>‚úì Copiado</span>';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        function copyAllAddresses() {
            const cards = document.querySelectorAll('.address-card');
            let allText = '';
            
            cards.forEach((card, index) => {
                const fields = card.querySelectorAll('.address-field .value');
                allText += `Direcci√≥n ${index + 1}:\n`;
                allText += Array.from(fields).map(f => f.textContent).join('\n');
                allText += '\n\n';
            });
            
            navigator.clipboard.writeText(allText).then(() => {
                const button = document.getElementById('copyAll');
                const originalText = button.innerHTML;
                button.innerHTML = '<span>‚úì Todas copiadas</span>';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                }, 2000);
            });
        }

        document.getElementById('generate').addEventListener('click', generateAddresses);
        document.getElementById('copyAll').addEventListener('click', copyAllAddresses);

        // API Panel functions
        function toggleApiPanel() {
            const panel = document.getElementById('apiPanel');
            const arrow = document.getElementById('apiToggleArrow');
            panel.classList.toggle('open');
            arrow.textContent = panel.classList.contains('open') ? '‚ñº' : '‚ñ∂';
        }

        function saveApiKey() {
            const input = document.getElementById('apiKeyInput');
            const key = input.value.trim();
            NameService.apiKey = key;
            if (key) {
                localStorage.setItem('randommer_api_key', key);
            } else {
                localStorage.removeItem('randommer_api_key');
            }
            NameService.updateStatusUI();

            // Visual feedback
            const btn = event.target.closest('button');
            const original = btn.innerHTML;
            btn.innerHTML = '<span>Guardado</span>';
            setTimeout(() => { btn.innerHTML = original; }, 1500);
        }

        // Initialize
        NameService.init();

        // Set initial selected country
        selectedLabel.textContent = addressData[selectedCountry].name;
        selectedFlag.textContent = addressData[selectedCountry].flag;

        // Generate initial addresses
        generateAddresses();
    </script>
</body>
</html>